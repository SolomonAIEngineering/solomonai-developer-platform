compatibility_date = "2024-09-23"
compatibility_flags = [ "nodejs_compat" ]
workers_dev = false
logpush = true

[env.production]
name = "user-service"
logpush = true
route = { pattern = "user-service.solomon-ai-platform.com/*", zone_name = "solomon-ai-platform.com" }

kv_namespaces = [
  { binding = "KV", id = "ebe4fa426a2c460185efbabc4d938e64" }
]

# the hyperdrive binding is used to access the hyperdrive service
[[env.production.hyperdrive]]
binding = "HYPERDRIVE"
id = "35ce83a30dc04eeaa671c4135774ed7f"

[env.production.observability]
enabled = true
head_sampling_rate = 0.01 # 10% of requests are logged

[[env.production.unsafe.bindings]]
name = "RATE_LIMITER"
type = "ratelimit"
namespace_id = "1001"
simple = { limit = 50000, period = 60 }

[env.staging]
name = "user-service-staging"
route = { pattern = "user-service-staging.solomon-ai-platform.com/*", zone_name = "solomon-ai-platform.com" }

kv_namespaces = [
  { binding = "KV", id = "7d39d035c7034acb8148e59a64e5dfa4" }
]

[env.staging.observability]
enabled = true
head_sampling_rate = 0.05 # 10% of requests are logged

[[env.staging.unsafe.bindings]]
name = "RATE_LIMITER"
type = "ratelimit"
namespace_id = "1002"
simple = { limit = 50000, period = 60 }

[[env.staging.hyperdrive]]
binding = "HYPERDRIVE"
id = "35ce83a30dc04eeaa671c4135774ed7f"

[[env.development.hyperdrive]]
binding = "HYPERDRIVE"
id = "c020574a-5623-407b-be0c-cd192bab9545"
localConnectionString = "postgresql://postgres:postgres@localhost:5432/social_service"